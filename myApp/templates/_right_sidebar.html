<!-- Right Column: AI Lesson Coach - Modern Chatbot Interface -->
<!-- Mobile/Tablet: Normal flow -->
<!-- Desktop: Fixed to right viewport edge -->
<div class="w-full lg:fixed lg:right-0 lg:top-24 lg:w-[280px] xl:w-[320px] lg:z-40 mt-6 lg:mt-0 sidebar-right-desktop">
    <div class="bg-[#0a0e27]/80 backdrop-blur-md border border-cyan-electric/10 rounded-xl lg:rounded-l-xl lg:rounded-r-none lg:sticky lg:top-24 lg:h-[calc(100vh-6rem)] lg:overflow-hidden flex flex-col sidebar-scroll border-r lg:border-r-0">
        <!-- Chat Header -->
        <div class="flex items-center gap-3 p-4 border-b border-cyan-electric/10 bg-gradient-to-r from-cyan-electric/5 to-transparent">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-cyan-electric via-purple-accent to-cyan-electric flex items-center justify-center shadow-lg shadow-cyan-electric/20">
                <i class="fas fa-sparkles text-white text-sm"></i>
            </div>
            <div class="flex-1 min-w-0">
                <div class="text-sm font-bold text-white truncate">{{ course.coach_name }}</div>
                <div class="text-xs text-cyan-electric/70 flex items-center gap-1">
                    <span class="w-1.5 h-1.5 rounded-full bg-cyan-electric animate-pulse"></span>
                    Online
                </div>
            </div>
            <button class="text-cyan-electric/70 hover:text-cyan-electric transition-colors" id="clear-chat" title="Clear chat">
                <i class="fas fa-trash-alt text-xs"></i>
            </button>
        </div>
        
        <!-- Chat Messages Area -->
        <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4 sidebar-scroll">
            <!-- Welcome Message -->
            <div class="chat-message ai-message">
                <div class="flex items-start gap-3">
                    <div class="w-7 h-7 rounded-full bg-gradient-to-br from-cyan-electric to-purple-accent flex items-center justify-center flex-shrink-0 mt-0.5">
                        <i class="fas fa-sparkles text-white text-xs"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="bg-[#0a0e27]/60 backdrop-blur-sm border border-cyan-electric/20 rounded-2xl rounded-tl-sm px-4 py-3">
                            <p class="text-sm text-gray-200 leading-relaxed">
                                Hi! I'm your AI Lesson Coach. I'm wired to this program and your lesson history. Ask me anything about this lesson, or try one of the suggestions below.
                            </p>
                        </div>
                        <div class="text-xs text-gray-500 mt-1.5 ml-1">Just now</div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Action Suggestions -->
            <div id="quick-suggestions" class="space-y-2">
                <button class="quick-suggestion-btn w-full text-left px-3 py-2.5 bg-cyan-electric/10 border border-cyan-electric/20 rounded-xl hover:bg-cyan-electric/20 hover:border-cyan-electric/40 transition-all text-xs font-medium text-cyan-electric/90" data-action="bullet-summary">
                    <i class="fas fa-list-ul mr-2"></i>5-bullet summary
                </button>
                <button class="quick-suggestion-btn w-full text-left px-3 py-2.5 bg-cyan-electric/10 border border-cyan-electric/20 rounded-xl hover:bg-cyan-electric/20 hover:border-cyan-electric/40 transition-all text-xs font-medium text-cyan-electric/90" data-action="action-plan">
                    <i class="fas fa-tasks mr-2"></i>3-step action plan
                </button>
                <button class="quick-suggestion-btn w-full text-left px-3 py-2.5 bg-cyan-electric/10 border border-cyan-electric/20 rounded-xl hover:bg-cyan-electric/20 hover:border-cyan-electric/40 transition-all text-xs font-medium text-cyan-electric/90" data-action="delegate-instructions">
                    <i class="fas fa-users mr-2"></i>Delegation guide
                </button>
            </div>
        </div>
        
        <!-- Chat Input Area -->
        <div class="border-t border-cyan-electric/10 bg-[#0a0e27]/40 p-3">
            <div class="relative">
                <textarea 
                    id="chat-input" 
                    rows="2" 
                    placeholder="Ask me anything about this lesson..." 
                    class="w-full bg-[#0a0e27]/60 border border-cyan-electric/20 rounded-xl px-4 py-3 pr-10 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-cyan-electric/50 focus:ring-1 focus:ring-cyan-electric/20 resize-none transition-all"
                ></textarea>
                <button 
                    id="send-message" 
                    class="absolute right-2 bottom-2 w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-electric to-purple-accent hover:from-cyan-electric/90 hover:to-purple-accent/90 flex items-center justify-center text-white shadow-lg shadow-cyan-electric/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                    title="Send message"
                >
                    <i class="fas fa-paper-plane text-xs"></i>
                </button>
            </div>
            <div class="flex items-center justify-between mt-2 px-1">
                <div class="text-[10px] text-gray-500 flex items-center gap-1">
                    <i class="fas fa-shield-alt"></i>
                    Private & secure
                </div>
                <div class="text-[10px] text-gray-500">
                    Press Enter to send
                </div>
            </div>
        </div>
    </div>
</div>
